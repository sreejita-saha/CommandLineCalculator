import java.util.ArrayList;
import java.util.List;
import java.util.Scanner;

public class AreaCalculator {

    private static final List<Double> savedAreas = new ArrayList<>(); // Stores only user-selected areas

    public static void displayAreaCalculator() {
        Scanner input = new Scanner(System.in);

        System.out.println("\nWelcome to the Area Calculator.");

        int choice;
        double area;  // Declare the area variable here for reusability

        do {
            System.out.println("The following options are: \n" +
                    "1. Floor/Wall Area (Rectangle)          2. Circle Area\n" +
                    "3. Sector of a Circle Area              4. Triangle Area \n" +
                    "5. Trapezoid Area                       6. Parallelogram Area \n" +
                    "7. Recall Saved Areas                   8. Add All Saved Areas \n" +
                    "0. Exit \nPlease enter all your dimensions in meters. \n" +
                    "If you need your calculations in a different dimensions you can use our Length Converter.");

            choice = getValidChoice(input);  // Get the user's choice

            switch (choice) {
                case 1: // Rectangle
                    System.out.print("Enter the length: ");
                    double length = input.nextDouble();
                    System.out.print("Enter the width: ");
                    double width = input.nextDouble();
                    area = length * width;
                    saveAreaPrompt(area, input);
                    break;

                case 2: // Circle
                    System.out.print("Enter the radius: ");
                    double radius = input.nextDouble();
                    area = Math.PI * radius * radius;
                    saveAreaPrompt(area, input);
                    break;

                case 3: // Sector of a Circle
                    System.out.print("Enter the radius: ");
                    radius = input.nextDouble();
                    System.out.print("Enter the angle (in degrees): ");
                    double angle = input.nextDouble();
                    area = (Math.PI * Math.pow(radius, 2) * angle) / 360;
                    saveAreaPrompt(area, input);
                    break;

                case 4: // Triangle
                    System.out.print("Enter the base: ");
                    double base = input.nextDouble();
                    System.out.print("Enter the height: ");
                    double height = input.nextDouble();
                    area = 0.5 * base * height;
                    saveAreaPrompt(area, input);
                    break;

                case 5: // Trapezoid
                    System.out.print("Enter the first base length: ");
                    base = input.nextDouble();
                    System.out.print("Enter the second base length: ");
                    double base2 = input.nextDouble();
                    System.out.print("Enter the height: ");
                    height = input.nextDouble();
                    area = 0.5 * (base + base2) * height;
                    saveAreaPrompt(area, input);
                    break;

                case 6: // Parallelogram
                    System.out.print("Enter the base length: ");
                    base = input.nextDouble();
                    System.out.print("Enter the height: ");
                    height = input.nextDouble();
                    area = base * height;
                    saveAreaPrompt(area, input);
                    break;

                case 7: // Recall Saved Areas
                    if (savedAreas.isEmpty()) {
                        System.out.println("No areas saved yet.");
                    } else {
                        System.out.println("Saved areas:");
                        for (int i = 0; i < savedAreas.size(); i++) {
                            System.out.printf("%d. %.2f square meters%n", i + 1, savedAreas.get(i));
                        }
                    }
                    break;

                case 8: // Add All Saved Areas
                    if (savedAreas.isEmpty()) {
                        System.out.println("No areas saved.");
                    } else {
                        double totalArea = savedAreas.stream().mapToDouble(Double::doubleValue).sum();
                        System.out.printf("Total of all saved areas = %.2f square meters.%n", totalArea);
                    }
                    break;

                case 0: // Exit
                    System.out.println("Exiting Area Calculator...");
                    return;
                default:
                    System.out.println("Invalid choice. Please select a valid option.");
            }

        } while (choice != 0);

        input.close();  // Close the scanner to avoid memory leaks
    }

    private static int getValidChoice(Scanner input) {
        int choice = -1;
        while (true) {
            System.out.print("Enter your choice: ");
            try {
                choice = Integer.parseInt(input.nextLine().trim());
                if (choice >= 0 && choice <= 8) {
                    return choice;
                }
                System.out.println("Please enter a number between 0 and 8.");
            } catch (NumberFormatException e) {
                System.out.println("Invalid input. Please enter a valid number.");
            }
        }
    }

    private static void saveAreaPrompt(double area, Scanner input) {
        System.out.printf("Area = %.2f square meters.%n", area);

        // Consume the leftover newline character from the previous input
        input.nextLine();  // This will clear the input buffer.

        String saveChoice;
        while (true) { // Loop until valid input
            System.out.print("Do you want to save this area for future use? (y/n): ");
            saveChoice = input.nextLine().trim().toLowerCase(); // Read the whole line
            if (saveChoice.equals("y")) {
                savedAreas.add(area);
                System.out.println("Area saved.");
                break;
            } else if (saveChoice.equals("n")) {
                System.out.println("Area was not saved.");
                break;
            } else {
                System.out.println("Invalid input. Please enter 'y' or 'n'.");
            }
        }
    }
}
